#!/bin/bash

echo "   _____ ____  __  __ __  __ _____ _______   __  __ ______  _____ _____         _____ ______ "
echo "  / ____/ __ \|  \/  |  \/  |_   _|__   __| |  \/  |  ____|/ ____/ ____|  /\   / ____|  ____|"
echo " | |   | |  | | \  / | \  / | | |    | |    | \  / | |__  | (___| (___   /  \ | |  __| |__   "
echo " | |   | |  | | |\/| | |\/| | | |    | |    | |\/| |  __|  \___ \\___ \ / /\ \| | |_ |  __|  "
echo " | |___| |__| | |  | | |  | |_| |_   | |    | |  | | |____ ____) |___) / ____ \ |__| | |____ "
echo "  \_____\____/|_|  |_|_|  |_|_____|  |_|    |_|  |_|______|_____/_____/_/    \_\_____|______|"
                                                                                                                                                                                                                       

commit_msg_file="$1"

commit_msg=$(cat "$commit_msg_file")
first_line=$(echo "$commit_msg" | head -n1)
pattern='^#[0-9]+[[:space:]].+'

if [[ $first_line =~ $pattern ]]; then
    echo "Commit message format is valid ✅"
    exit 0
else
    echo "❌ Invalid commit message format!"
    echo "Expected format: #123 Your commit message"
    echo "Your message: ${first_line}"
    echo ""
    echo "Examples of valid commit messages:"
    echo "  #42 Add user authentication feature"
    echo "  #123 Fix navigation bug in mobile view"
    echo "  #1 Initial project setup"
    echo ""
    echo "Commit rejected. Please fix your commit message format."
    exit 1
fi